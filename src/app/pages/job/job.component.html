<h1 class="text-3xl">Applications : {{ applications.length }}</h1>
<div *ngIf="!applications.length">
    Loading...
</div>

<p-table *ngIf="applications && applications.length > 0" [value]="applications" [style]="{'min-width': '50rem'}">
    <ng-template pTemplate="header" let-columns>
        <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Level</th>
            <th>Profile</th>
            <th>Applicant State</th>
            <th>Application Message</th>
            <th>Application Status</th>
            <th>Actions</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-application let-columns="columns">
        <tr>
            <!-- Name -->
            <td>{{ application.applicant.firstName }} {{ application.applicant.lastName }}</td>

            <!-- Email -->
            <td>
                <a *ngIf="application.applicant.email" [href]="'mailto:' + application.applicant.email">
                    {{ application.applicant.email }}
                </a>
            </td>

            <!-- Level -->
            <td>{{ application.job.level }}</td>


            <!-- Profile -->
            <td>{{ application.job.profile }}</td>

            <!-- applicant state -->
            <td>{{ application.applicant.state }}</td>

            <!-- Application Message -->
            <td>{{ application.message }}</td>

            <!-- Application Status -->
            <td>{{ application.status }}</td>

            <!-- Actions -->
            <td>
                <div class="w-52 mx-2 my-2">
                <button
                    pButton
                    icon="pi pi-check"
                    class="px-4 py-2 mr-4 bg-green-500 text-white rounded hover:bg-green-700 focus:outline-none focus:shadow-outline-green active:bg-green-800"
                    (click)="acceptApplication(application?.id)"
                >Accept</button>
                <button
                    pButton
                    icon="pi pi-times"
                    class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-700 focus:outline-none focus:shadow-outline-red active:bg-red-800"
                    (click)="refuseApplication(application?.id)"
                >Refuse
            </button>
            </div>
                <div class="w-52 mx-2 z-40">
                    <a [href]="getfile(application?.applicant?.cv)" download class="cssbuttons-io-button">
                        <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M1 14.5a6.496 6.496 0 0 1 3.064-5.519 8.001 8.001 0 0 1 15.872 0 6.5 6.5 0 0 1-2.936 12L7 21c-3.356-.274-6-3.078-6-6.5zm15.848 4.487a4.5 4.5 0 0 0 2.03-8.309l-.807-.503-.12-.942a6.001 6.001 0 0 0-11.903 0l-.12.942-.805.503a4.5 4.5 0 0 0 2.029 8.309l.173.013h9.35l.173-.013zM13 12h3l-4 5-4-5h3V8h2v4z" fill="currentColor"></path>
                        </svg>
                        <span>Download CV</span>
                    </a>
                </div>
            </td>
        </tr>
    </ng-template>
</p-table>
